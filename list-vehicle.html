<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="List your vehicle on Xpresso">
    <title>List Your Vehicle - Xpresso</title>

    <!-- CSS -->
    <link rel="stylesheet" href="css/global.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/pages.css">
</head>

<body>
    <!-- Header -->
    <header class="header" id="header">
        <div class="container">
            <nav class="navbar">
                <a href="index.html" class="logo">
                    <img src="logo.png" alt="Xpresso" class="logo-icon"
                        style="width: 40px; height: 40px; object-fit: contain;">
                    <span class="logo-text">Xpresso</span>
                </a>

                <ul class="nav-menu">
                    <li><a href="index.html" class="nav-link">Home</a></li>
                    <li><a href="browse.html" class="nav-link">Browse</a></li>
                    <li><a href="dashboard.html" class="nav-link">My Rentals</a></li>`n <li><a href="policies.html"
                            class="nav-link">Policies</a></li>
                </ul>

                <div class="nav-actions">
                    <a href="dashboard.html" class="btn btn-secondary">Dashboard</a>
                    <a href="login.html" class="btn btn-primary">Login</a>
                </div>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="list-vehicle-page">
        <div class="container">
            <div class="form-container">
                <h1>List Your Vehicle</h1>
                <p class="text-light mb-4">Fill in the details to list your vehicle for rent</p>

                <!-- Progress Steps -->
                <div class="form-steps">
                    <div class="form-step active">
                        <div class="step-circle">1</div>
                        <span class="step-label">Basic Details</span>
                    </div>
                    <div class="form-step">
                        <div class="step-circle">2</div>
                        <span class="step-label">Photos</span>
                    </div>
                    <div class="form-step">
                        <div class="step-circle">3</div>
                        <span class="step-label">Pricing</span>
                    </div>
                    <div class="form-step">
                        <div class="step-circle">4</div>
                        <span class="step-label">Location</span>
                    </div>
                </div>

                <!-- Step Content -->
                <div class="form-content">
                    <!-- Step 1: Basic Details -->
                    <div class="step-content active" id="step-1">
                        <h2>Basic Details</h2>

                        <div class="form-group">
                            <label class="form-label" for="vehicle-type">Vehicle Type *</label>
                            <select id="vehicle-type" class="form-select" required onchange="updateBrands()">
                                <option value="">Select type</option>
                                <option value="Scooty">Scooty</option>
                                <option value="Bike">Bike</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="brand">Brand *</label>
                            <select id="brand" class="form-select" required>
                                <option value="">Select brand</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="model">Model *</label>
                            <input type="text" id="model" class="form-input" placeholder="e.g., Activa 6G" required>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label" for="year">Year *</label>
                                <input type="number" id="year" class="form-input" placeholder="2023" min="2000"
                                    max="2025" required>
                            </div>

                            <div class="form-group">
                                <label class="form-label" for="registration">Registration Number *</label>
                                <input type="text" id="registration" class="form-input" placeholder="GJ06XY1234"
                                    required>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label" for="gear-type">Gear Type *</label>
                                <select id="gear-type" class="form-select" required>
                                    <option value="">Select gear type</option>
                                    <option value="Automatic">Automatic</option>
                                    <option value="Manual">Manual</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label class="form-label" for="fuel-type">Fuel Type *</label>
                                <select id="fuel-type" class="form-select" required>
                                    <option value="">Select fuel type</option>
                                    <option value="Petrol">Petrol</option>
                                    <option value="Electric">Electric</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="mileage">Mileage *</label>
                            <input type="text" id="mileage" class="form-input" placeholder="e.g., 45 km/l" required>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="description">Description</label>
                            <textarea id="description" class="form-input" rows="3"
                                placeholder="Brief description of your vehicle"></textarea>
                        </div>
                    </div>

                    <!-- Step 2: Photos -->
                    <div class="step-content" id="step-2">
                        <h2>Upload Photos</h2>
                        <p class="text-light mb-4">Upload clear photos of your vehicle (minimum 1, maximum 5)</p>

                        <div class="upload-grid">
                            <div class="upload-area" onclick="document.getElementById('photo-1').click()">
                                <p style="font-size: 48px; margin: 0;">üì∑</p>
                                <p>Upload Photo 1 *</p>
                                <input type="file" id="photo-1" accept="image/*" style="display: none;">
                                <img id="preview-1"
                                    style="display: none; max-width: 100%; max-height: 200px; border-radius: 8px;">
                            </div>

                            <div class="upload-area" onclick="document.getElementById('photo-2').click()">
                                <p style="font-size: 48px; margin: 0;">üì∑</p>
                                <p>Upload Photo 2</p>
                                <input type="file" id="photo-2" accept="image/*" style="display: none;">
                                <img id="preview-2"
                                    style="display: none; max-width: 100%; max-height: 200px; border-radius: 8px;">
                            </div>

                            <div class="upload-area" onclick="document.getElementById('photo-3').click()">
                                <p style="font-size: 48px; margin: 0;">üì∑</p>
                                <p>Upload Photo 3</p>
                                <input type="file" id="photo-3" accept="image/*" style="display: none;">
                                <img id="preview-3"
                                    style="display: none; max-width: 100%; max-height: 200px; border-radius: 8px;">
                            </div>
                        </div>
                    </div>

                    <!-- Step 3: Pricing -->
                    <div class="step-content" id="step-3">
                        <h2>Set Your Pricing</h2>

                        <div class="form-group">
                            <label class="form-label" for="price-hour">Price per Hour (‚Çπ) *</label>
                            <input type="number" id="price-hour" class="form-input" placeholder="30" min="10" required>
                            <p class="text-small text-light mt-1">Recommended: ‚Çπ25-‚Çπ60 for scooties, ‚Çπ40-‚Çπ100 for bikes
                            </p>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="price-day">Price per Day (‚Çπ) *</label>
                            <input type="number" id="price-day" class="form-input" placeholder="400" min="100" required>
                            <p class="text-small text-light mt-1">Recommended: ‚Çπ300-‚Çπ600 for scooties, ‚Çπ500-‚Çπ1000 for
                                bikes</p>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="deposit">Security Deposit (‚Çπ) *</label>
                            <input type="number" id="deposit" class="form-input" placeholder="2000" min="500" required>
                            <p class="text-small text-light mt-1">Recommended: ‚Çπ1500-‚Çπ3000 for scooties, ‚Çπ3000-‚Çπ5000 for
                                bikes</p>
                        </div>
                    </div>

                    <!-- Step 4: Location & Rules -->
                    <div class="step-content" id="step-4">
                        <h2>Location & Rules</h2>

                        <div class="form-group">
                            <label class="form-label" for="location">Location *</label>
                            <select id="location" class="form-select" required>
                                <option value="">Select location</option>
                                <option value="Waghodia Road">Waghodia Road</option>
                                <option value="Alkapuri">Alkapuri</option>
                                <option value="Sayajigunj">Sayajigunj</option>
                                <option value="Manjalpur">Manjalpur</option>
                                <option value="Fatehgunj">Fatehgunj</option>
                                <option value="Race Course">Race Course</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Rental Rules</label>
                            <div class="form-checkbox">
                                <input type="checkbox" id="rule-helmet" checked disabled>
                                <label for="rule-helmet">Helmet mandatory (required)</label>
                            </div>
                            <div class="form-checkbox">
                                <input type="checkbox" id="rule-smoking">
                                <label for="rule-smoking">No smoking</label>
                            </div>
                            <div class="form-checkbox">
                                <input type="checkbox" id="rule-fuel">
                                <label for="rule-fuel">Return with same fuel level</label>
                            </div>
                            <div class="form-checkbox">
                                <input type="checkbox" id="rule-license">
                                <label for="rule-license">Valid license required</label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="custom-rules">Additional Rules (Optional)</label>
                            <textarea id="custom-rules" class="form-input" rows="3"
                                placeholder="Any other rules or requirements"></textarea>
                        </div>

                        <div class="form-checkbox">
                            <input type="checkbox" id="agree-policies" required>
                            <label for="agree-policies">I agree to the <a href="policies.html" target="_blank">Xpresso
                                    Policies</a> and confirm all information is
                                accurate</label>
                        </div>
                    </div>
                </div>

                <!-- Navigation Buttons -->
                <div class="form-actions">
                    <button class="btn btn-secondary" id="prev-btn" onclick="previousStep()"
                        style="visibility: hidden;">
                        ‚Üê Previous
                    </button>
                    <button class="btn btn-primary" id="next-btn" onclick="nextStep()">
                        Next ‚Üí
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Xpresso</h3>
                    <p>Affordable vehicle rentals for students in Vadodara</p>
                </div>
                <div class="footer-section">
                    <h4>Quick Links</h4>
                    <ul class="footer-links">
                        <li><a href="browse.html">Browse Vehicles</a></li>
                        <li><a href="list-vehicle.html">List Your Vehicle</a></li>
                        <li><a href="policies.html">Policies</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Support</h4>
                    <ul class="footer-links">
                        <li><a href="policies.html">Terms & Conditions</a></li>
                        <li><a href="policies.html">Privacy Policy</a></li>
                        <li><a href="mailto:support@Xpresso.com">Contact Us</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Xpresso. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Toast Container -->
    <div id="toast-container" class="toast-container"></div>

    <!-- Scripts -->
    <script src="js/utils.js"></script>
    <script src="js/data.js"></script>
    <script src="js/auth.js"></script>
    <script>
        let currentStep = 1;
        const totalSteps = 4;
        const formData = {
            photos: []
        };

        // Image upload handlers
        for (let i = 1; i <= 3; i++) {
            document.getElementById(`photo-${i}`).addEventListener('change', function (e) {
                handleImageUpload(e, i);
            });
        }

        function handleImageUpload(event, photoNum) {
            const file = event.target.files[0];
            if (!file) return;

            if (file.size > 8 * 1024 * 1024) {
                Utils.showToast('File too large (max 8MB)', 'error');
                return;
            }

            const reader = new FileReader();
            reader.onload = function (e) {
                formData.photos[photoNum - 1] = e.target.result;
                const preview = document.getElementById(`preview-${photoNum}`);
                preview.src = e.target.result;
                preview.style.display = 'block';
            };
            reader.readAsDataURL(file);
        }

        function updateBrands() {
            const vehicleType = document.getElementById('vehicle-type').value;
            const brandSelect = document.getElementById('brand');

            brandSelect.innerHTML = '<option value="">Select brand</option>';

            if (vehicleType && MockData.brands[vehicleType]) {
                MockData.brands[vehicleType].forEach(brand => {
                    const option = document.createElement('option');
                    option.value = brand;
                    option.textContent = brand;
                    brandSelect.appendChild(option);
                });
            }
        }

        function nextStep() {
            if (!validateCurrentStep()) return;

            if (currentStep < totalSteps) {
                currentStep++;
                updateStepDisplay();
            } else {
                submitListing();
            }
        }

        function previousStep() {
            if (currentStep > 1) {
                currentStep--;
                updateStepDisplay();
            }
        }

        function validateCurrentStep() {
            switch (currentStep) {
                case 1:
                    const type = document.getElementById('vehicle-type').value;
                    const brand = document.getElementById('brand').value;
                    const model = document.getElementById('model').value;
                    const year = document.getElementById('year').value;
                    const registration = document.getElementById('registration').value;
                    const gearType = document.getElementById('gear-type').value;
                    const fuelType = document.getElementById('fuel-type').value;
                    const mileage = document.getElementById('mileage').value;

                    if (!type || !brand || !model || !year || !registration || !gearType || !fuelType || !mileage) {
                        Utils.showToast('Please fill all required fields', 'error');
                        return false;
                    }

                    if (!Utils.validateRegistrationNumber(registration)) {
                        Utils.showToast('Invalid registration number format (e.g., GJ06XY1234)', 'error');
                        return false;
                    }
                    return true;

                case 2:
                    if (formData.photos.length === 0 || !formData.photos[0]) {
                        Utils.showToast('Please upload at least one photo', 'error');
                        return false;
                    }
                    return true;

                case 3:
                    const priceHour = document.getElementById('price-hour').value;
                    const priceDay = document.getElementById('price-day').value;
                    const deposit = document.getElementById('deposit').value;

                    if (!priceHour || !priceDay || !deposit) {
                        Utils.showToast('Please fill all pricing fields', 'error');
                        return false;
                    }

                    if (priceHour < 10 || priceDay < 100 || deposit < 500) {
                        Utils.showToast('Please enter valid pricing amounts', 'error');
                        return false;
                    }
                    return true;

                case 4:
                    const location = document.getElementById('location').value;
                    const agreePolicies = document.getElementById('agree-policies').checked;

                    if (!location) {
                        Utils.showToast('Please select a location', 'error');
                        return false;
                    }

                    if (!agreePolicies) {
                        Utils.showToast('Please agree to the policies', 'error');
                        return false;
                    }
                    return true;

                default:
                    return true;
            }
        }

        function updateStepDisplay() {
            // Update step indicators
            document.querySelectorAll('.form-step').forEach((step, index) => {
                if (index + 1 < currentStep) {
                    step.classList.add('completed');
                    step.classList.remove('active');
                    step.querySelector('.step-circle').textContent = '‚úì';
                } else if (index + 1 === currentStep) {
                    step.classList.add('active');
                    step.classList.remove('completed');
                    step.querySelector('.step-circle').textContent = index + 1;
                } else {
                    step.classList.remove('active', 'completed');
                    step.querySelector('.step-circle').textContent = index + 1;
                }
            });

            // Update step content
            document.querySelectorAll('.step-content').forEach((content, index) => {
                content.classList.toggle('active', index + 1 === currentStep);
            });

            // Update buttons
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');

            prevBtn.style.visibility = currentStep === 1 ? 'hidden' : 'visible';
            nextBtn.textContent = currentStep === totalSteps ? 'Submit Listing' : 'Next ‚Üí';
        }

        function submitListing() {
            const user = Auth.getCurrentUser();

            if (!user) {
                Utils.showToast('Please login to list a vehicle', 'error');
                setTimeout(() => window.location.href = 'login.html', 1500);
                return;
            }

            if (!user.verified) {
                Utils.showToast('Please complete verification first', 'error');
                setTimeout(() => window.location.href = 'verification.html', 1500);
                return;
            }

            Utils.showToast('Vehicle listed successfully!', 'success');
            setTimeout(() => window.location.href = 'dashboard.html', 2000);
        }

        // Header scroll effect
        window.addEventListener('scroll', function () {
            const header = document.getElementById('header');
            if (window.scrollY > 10) {
                header.classList.add('scrolled');
            } else {
                header.classList.remove('scrolled');
            }
        });
    </script>
</body>

</html>